## Env

### Прокинуть переменную через темплейт пода
[deployment-with-env.yaml](../practice/4.saving-configurations/1.env/deployment-with-env.yaml)

В темплейте пода мы можем прокинуть в контейнер перемменую окружения
```bash
    spec:
      containers:
        env:
        - name: TEST
          value: foo
```

Если провалитьс в описание пода, мы видим

    Environment:
      TEST:  foo

!! В результате, это не всегда удобно. Например у нас есть какой-то общий адрес русурса, 
и нам придется править его в нескольких местах

### ConfigMap
[configmap.yaml](../practice/4.saving-configurations/1.env/configmap.yaml)
Переменный окружения мы можен сложить в таком формате и тогда в депломентах мы можем ссылаться
на эту конфигМапу по ее имени в ямле

Для начала эту конфигМапу мы деплоим в куб
```bash
 kubectl apply -f configmap.yaml 
```
Получим конфигМапу
```bash
kubectl get cm
```
```bash
NAME               DATA   AGE
kube-root-ca.crt   1      147d # Служебный, создан самим кубом
my-configmap-env   2      22s # Наш, DATA 2 значит, что лежит два ключа
```

Накатим теперь деплоймент, который внутри своего шаблона ссылается на наш CM
```bash
kubectl apply -f deployment-with-env-cm.yaml 
```
В описании пода мы видим, что мы берем какие-то переменные из cm но не видно какие именно
```bash
Environment Variables from:
      my-configmap-env  ConfigMap  Optional: false
```

Как узнать: что там внутри?
1. Зайти в cm и посмотреть
    ```bash
     kubectl get cm my-configmap-env -o yaml
    ```
   ```bash
   apiVersion: v1
   data:
     DEBUG: "false"
     dbhost: postgresql
   kind: ConfigMap
   metadata:
     annotations:
       kubectl.kubernetes.io/last-applied-configuration: |
         {"apiVersion":"v1","data":{"DEBUG":"false","dbhost":"postgresql"},"kind":"ConfigMap","metadata":{"annotations":{},"name":"my-configmap-env","namespace":"default"}}
     creationTimestamp: "2026-02-24T16:36:46Z"
     name: my-configmap-env
     namespace: default
     resourceVersion: "13962"
     uid: 9f18522e-6b70-4b8a-958e-a8d3c208cf1f
   ```
2. Зайти в контейнер и если там есть какой-нить shell и посмотреть, какие там есть переменные окружения

   ```bash
     kubectl exec -it my-deployment-7ff4448d96-9r77x -- bash #  так мы попадем в шелл, но можем сразу env посмотреть
   ```
   ```bash
     kubectl exec -it my-deployment-7ff4448d96-9r77x -- env 
   ```
   ```bash
   PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
   HOSTNAME=my-deployment-7ff4448d96-9r77x
   TERM=xterm
   DEBUG=false # наша
   dbhost=postgresql # наша
   TEST=foo # наша
   KUBERNETES_PORT_443_TCP_ADDR=10.96.0.1
   KUBERNETES_SERVICE_HOST=10.96.0.1
   KUBERNETES_SERVICE_PORT=443
   KUBERNETES_SERVICE_PORT_HTTPS=443
   KUBERNETES_PORT=tcp://10.96.0.1:443
   KUBERNETES_PORT_443_TCP=tcp://10.96.0.1:443
   KUBERNETES_PORT_443_TCP_PROTO=tcp
   KUBERNETES_PORT_443_TCP_PORT=443
   NGINX_VERSION=1.12.2-1~stretch
   NJS_VERSION=1.12.2.0.1.14-1~stretch
   HOME=/root
   ```